<div class="container-funcionarios mt-4">

  <!-- ===== BREADCRUMB COM BOTÃO ===== -->
  <div class="custom-breadcrumb d-flex justify-content-between align-items-center mb-4">
    <nav>
      <ol>
        <li>
          <a routerLink="/home">
            <i class="fa-solid fa-house"></i>
            <span>Home</span>
          </a>
        </li>
        <li>
          <a routerLink="/home/_cad">
            <i class="fa-solid fa-folder-open"></i>
            <span>Cadastro</span>
          </a>
        </li>
        <li class="active">
          <i class="fa-solid fa-solid fa-user"></i>
          <span>Pessoas</span>
        </li>
      </ol>
    </nav>

    <button class="btn btn-primary btn-breadcrumb" (click)="novo()">
      <i class="fa-solid fa-plus"></i> Nova Pessoa
    </button>
  </div>

  <!-- CAMPO DE FILTRO -->
  <!-- FILTRO POR NOME -->
  <div class="row mb-3 align-items-end">

    <div class="col-md-4">
      <label class="form-label">Filtrar por nome</label>
      <input type="text" class="form-control" [(ngModel)]="filtroNome" placeholder="Digite um nome" />
    </div>

    <div class="col-md-4 d-flex gap-2">

      <button class="btn btn-primary" (click)="filtrar()">
        <i class="fa-solid fa-filter"></i> Filtrar
      </button>

      <button class="btn btn-secondary" (click)="limparFiltro()">
        <i class="fa-solid fa-eraser"></i> Limpar
      </button>

    </div>

  </div>


  <div *ngIf="loading">Carregando...</div>
  <div *ngIf="error">{{ error }}</div>

  <table class="table table-striped" *ngIf="!loading && pessoas.length">
    <thead>
      <tr>
        <th>Tipo</th>
        <th>Nome</th>
        <th>Cidade</th>
        <th>Estado</th>
        <th>Status</th>
        <th>Cadastro</th>
        <th>Ações</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let p of pessoasPaginadas">
        <td>
          <span [ngClass]="{
              'icon-building': p.tipoPessoa === 'J',
              'icon-house': p.tipoPessoa === 'F'
          }"></span>
        </td>
        <td>{{ p.nome }}</td>
        <td>{{ p.cidade.nomeCidade }}</td>
        <td>{{ p.cidade.nomeEstado }}</td>
        <td>
          <span class="status-bolinha" [ngClass]="p.ativo == 1 ? 'ativo' : 'inativo'">
          </span>
        </td>
        <td>{{ p.dataCadastro | date:'dd/MM/yyyy'  }}</td>
        <td>
          <button class="btn btn-sm btn-warning me-2" (click)="editar(p.id)"> <i class="fa-solid fa-pen"></i></button>
          <button class="btn btn-sm btn-danger" (click)="excluir(p)"> <i class="fa-solid fa-trash"></i></button>
        </td>
      </tr>
    </tbody>
  </table>

  <p *ngIf="!loading && !pessoas.length">Nenhuma pessoa encontrada.</p>

  <!-- ===== PAGINAÇÃO ===== -->
  <div class="d-flex justify-content-between align-items-center mt-3">
    <div class="text-muted small">
      Mostrando {{ exibicaoInicio }} - {{ exibicaoFim }} de {{ totalItens }}
    </div>

    <nav>
      <ul class="pagination pagination-sm mb-0">

        <li class="page-item" [class.disabled]="paginaAtual === 0">
          <button class="page-link" (click)="mudarPagina(paginaAtual - 1)" [disabled]="paginaAtual === 0">
            Anterior
          </button>
        </li>
        <!-- 
        <li
          class="page-item"
          *ngFor="let p of paginas"
          [class.active]="p === paginaAtual"
          [hidden]="paginas.length <= 1"
        >
          <button class="page-link" (click)="mudarPagina(p)">{{ p + 1 }}</button>
        </li> -->

        <li class="page-item"
          [class.disabled]="(paginaAtual + 1) * itensPorPagina >= pessoas.length || pessoas.length === 0">
          <button class="page-link" (click)="mudarPagina(paginaAtual + 1)"
            [disabled]="(paginaAtual + 1) * itensPorPagina >= pessoas.length || pessoas.length === 0">
            Próxima
          </button>
        </li>
      </ul>
    </nav>
  </div>

</div>