<div class="container-funcionarios mt-4">

  <!-- ===== CABEÇALHO ===== -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold mb-0">Funcionários</h3>
    <button class="btn btn-primary" (click)="novoFuncionario()">
      <i class="fa-solid fa-plus"></i> Novo Funcionário
    </button>
  </div>

  <!-- ===== PAINEL UNIFICADO ===== -->
  <div class="card shadow-sm">
    <div class="card-body">
      <h6 class="text-muted mb-1">VISÃO GERAL</h6>
      <h5 class="fw-bold mb-4">Painel de Controle</h5>

      <div class="painel-detalhes flex-wrap">

        <!-- ===== TOTAIS ===== -->
        <div class="painel-item">
          <i class="fa-solid fa-users text-secondary"></i>
          <div>Total</div>
          <div class="valor">{{ funcionarios.length }}</div>
        </div>

        <div class="painel-divider"></div>

        <div class="painel-item">
          <i class="fa-solid fa-user-check text-success"></i>
          <div>Ativos</div>
          <div class="valor">{{ funcionariosAtivos }}</div>
        </div>

        <div class="painel-divider"></div>

        <div class="painel-item">
          <i class="fa-solid fa-user-xmark text-danger"></i>
          <div>Inativos</div>
          <div class="valor">{{ funcionariosInativos }}</div>
        </div>

        <div class="painel-divider"></div>

        <!-- ===== FUNÇÕES ===== -->
        <ng-container *ngFor="let func of funcoesComQuantidade; let i = index">
          <div class="painel-item">
            <i class="fa-solid fa-briefcase text-primary"></i>
            <div>{{ func.nomeFuncao }}</div>
            <div class="valor">{{ func.quantidade }}</div>
          </div>
          <div
            class="painel-divider"
            *ngIf="i < funcoesComQuantidade.length - 1"
          ></div>
        </ng-container>
      </div>
    </div>
  </div>

  <!-- ===== TABELA ===== -->
  <div class="table-responsive bg-white shadow-sm rounded mt-4">
    <table class="table align-middle mb-0">
      <thead class="table-light">
        <tr>
          <th>Nome</th>
          <th>Email</th>
          <th>Função</th>
          <th>Grupo Usuário</th>
          <th class="text-center">Ativo</th>
          <th class="text-end">Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let f of funcionariosPaginados">
          <td>{{ f.nomeFuncionario }}</td>
          <td>{{ f.emailFuncionario }}</td>
          <td>{{ f.nomeFuncao }}</td>
          <td>{{ f.nomeGrupoUsuario || '-' }}</td>
          <td class="text-center">
            <span class="badge" [class.bg-success]="f.ativo" [class.bg-danger]="!f.ativo">
              {{ f.ativo ? 'Ativo' : 'Inativo' }}
            </span>
          </td>
          <td class="text-end">
            <button class="btn btn-sm btn-outline-primary me-2" (click)="editar(f)">
              <i class="fa-solid fa-pen"></i>
            </button>
            <button class="btn btn-sm btn-outline-danger" (click)="excluir(f)">
              <i class="fa-solid fa-trash"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- ===== PAGINAÇÃO ===== -->
  <div class="d-flex justify-content-between align-items-center mt-3">
    <div class="text-muted small">
      Mostrando {{ paginaAtual * itensPorPagina + 1 }} -
      {{ Math.min((paginaAtual + 1) * itensPorPagina, funcionarios.length) }}
      de {{ funcionarios.length }}
    </div>

    <nav>
      <ul class="pagination pagination-sm mb-0">
        <li class="page-item" [class.disabled]="paginaAtual === 0">
          <a class="page-link" (click)="mudarPagina(paginaAtual - 1)">Anterior</a>
        </li>
        <li
          class="page-item"
          *ngFor="let p of paginas"
          [class.active]="p === paginaAtual"
        >
          <a class="page-link" (click)="mudarPagina(p)">{{ p + 1 }}</a>
        </li>
        <li
          class="page-item"
          [class.disabled]="(paginaAtual + 1) * itensPorPagina >= funcionarios.length"
        >
          <a class="page-link" (click)="mudarPagina(paginaAtual + 1)">Próxima</a>
        </li>
      </ul>
    </nav>
  </div>

</div>
